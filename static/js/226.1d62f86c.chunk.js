"use strict";(self.webpackChunkcommunity_ai=self.webpackChunkcommunity_ai||[]).push([[226],{8226:function(e,s,a){a.r(s),a.d(s,{default:function(){return N}});var r=a(2791),i=a(6871),l=a(1413),n=a(885),t=a(2270),o=a(5005),c=a(4153),d=a(1795),m=a(7665),u=a(4059),h=a(184),f=c.Ry().shape({firstname:c.Z_().min(3,"Minimum 3 characters").max(50,"Maximum 50 characters").required("First Name is required"),lastname:c.Z_().min(3,"Minimum 3 characters").max(50,"Maximum 50 characters").required("Last Name is required"),mobileNumber:c.Z_().min(14,"Minimum 10 numbers").max(14,"Maximum 10 numbers").required("Mobile number is required")}),b=function(){var e,s=(0,r.useState)(!1),a=(0,n.Z)(s,2),i=a[0],c=a[1],b=(0,m.aC)(),x=b.currentUser,p=b.auth,v=b.setCurrentUser,g=b.saveAuth,j=(0,r.useState)(""),w=(0,n.Z)(j,2),N=w[0],y=w[1],_=(0,r.useState)(null===x||void 0===x?void 0:x.id),P=(0,n.Z)(_,1)[0],k=(0,r.useState)(!1),S=(0,n.Z)(k,2),Z=S[0],F=S[1],C=(0,r.useState)(""),T=(0,n.Z)(C,2),M=T[0],q=T[1],A=(0,r.useState)(""),E=(0,n.Z)(A,2),U=E[0],I=E[1],V=(0,r.useState)(null===x||void 0===x?void 0:x.phoneNumber),R=(0,n.Z)(V,2),D=(R[0],R[1]),L=(0,r.useState)(null===x||void 0===x?void 0:x.mobileNumber),W=(0,n.Z)(L,2),H=W[0],O=W[1];""!==M&&setTimeout((function(){F(!1),setTimeout((function(){q("")}),200)}),5e3),""!==U&&setTimeout((function(){F(!1),setTimeout((function(){I("")}),200)}),5e3);var Y,B=(0,r.useState)(!!(Y=null===x||void 0===x?void 0:x.orgType)&&"Management Company"!=Y&&"Self Managed Community"!=Y),X=(0,n.Z)(B,2),z=(X[0],X[1],(0,r.useState)(null===x||void 0===x?void 0:x.orgType)),G=(0,n.Z)(z,2),J=(G[0],G[1],{firstname:null===x||void 0===x?void 0:x.firstname,lastname:null===x||void 0===x?void 0:x.lastname,mobileNumber:null===x||void 0===x?void 0:x.mobileNumber}),K=(0,d.TA)({initialValues:J,validationSchema:f,onSubmit:function(e){c(!0),setTimeout((function(){var s=new FormData;console.log(e.firstname),s.append("userId",P?P.toString():""),s.append("firstname",e.firstname),s.append("lastname",e.lastname),s.append("mobileNumber",e.mobileNumber),s.append("image",N),(0,o.Lj)(s).then((function(e){e.data.success?(v((function(s){var a=s;a=(0,l.Z)((0,l.Z)({},a),e.data.userData);var r=p;return r&&r.user&&(r.user=a),g(r),a})),F(!0),q(e.data.message),c(!1),window.scrollTo(0,0)):(F(!0),I(e.data.message),c(!1),window.scrollTo(0,0))})).catch((function(e){F(!0),I("Failed to update user profile details"),c(!1),window.scrollTo(0,0)}))}),1e3)}});(0,r.useEffect)((function(){K.setFieldValue("mobileNumber",H)}),[H]);var Q=function(e){if(!e)return e;var s=e.replace(/[^\d]/g,""),a=s.length;return a<4?s:a<7?"(".concat(s.slice(0,3),") ").concat(s.slice(3)):"(".concat(s.slice(0,3),") ").concat(s.slice(3,6),"-").concat(s.slice(6,10))};return(0,h.jsxs)("div",{className:"card mb-5 mb-xl-10",children:[(0,h.jsx)("div",{className:"card-header border-0 cursor-pointer",role:"button","data-bs-toggle":"collapse","data-bs-target":"#kt_account_profile_details","aria-expanded":"true","aria-controls":"kt_account_profile_details",children:(0,h.jsx)("div",{className:"card-title m-0",children:(0,h.jsx)("h3",{className:"fw-bolder m-0",children:"User Profile Details"})})}),""!==M?(0,h.jsx)(u.FP,{message:M,checked:Z}):null,""!==U?(0,h.jsx)(u.Nq,{message:U,checked:Z}):null,(0,h.jsx)("div",{id:"kt_account_profile_details",className:"collapse show",children:(0,h.jsxs)("form",{onSubmit:K.handleSubmit,noValidate:!0,className:"form",children:[(0,h.jsxs)("div",{className:"card-body border-top p-9",children:[(0,h.jsxs)("div",{className:"row mb-6",children:[(0,h.jsx)("label",{className:"col-lg-4 col-form-label fw-bold fs-6",children:"Avatar"}),(0,h.jsx)("div",{className:"col-lg-8",children:(0,h.jsxs)("div",{className:"image-input image-input-outline","data-kt-image-input":"true",style:{backgroundImage:"url(".concat((0,t.BY)("/media/avatars/blank.png"),")")},children:[""==N?(0,h.jsx)("div",{children:(0,h.jsx)("img",{src:"".concat("http://34.135.116.158:5050/user-avatars","/").concat(null===p||void 0===p||null===(e=p.user)||void 0===e?void 0:e.avatarName),className:"w-200px mb-3"})}):(0,h.jsx)("div",{children:(0,h.jsx)("img",{src:URL.createObjectURL(N),className:"w-200px mb-3"})}),(0,h.jsx)("div",{children:(0,h.jsx)("input",{type:"file",id:"image",accept:"image/png, image/jpeg, image/jpg",onChange:function(e){return function(e){y(e.target.files[0])}(e)}})})]})})]}),(0,h.jsxs)("div",{className:"row mb-6",children:[(0,h.jsx)("label",{className:"col-lg-4 col-form-label required fw-bold fs-6",children:"Full Name"}),(0,h.jsx)("div",{className:"col-lg-8",children:(0,h.jsxs)("div",{className:"row",children:[(0,h.jsxs)("div",{className:"col-lg-6 fv-row",children:[(0,h.jsx)("input",(0,l.Z)({type:"text",className:"form-control form-control-lg form-control-solid mb-3 mb-lg-0",placeholder:"First Name"},K.getFieldProps("firstname"))),K.touched.firstname&&K.errors.firstname&&(0,h.jsx)("div",{className:"fv-plugins-message-container",children:(0,h.jsx)("div",{className:"fv-help-block",children:(0,h.jsx)(h.Fragment,{children:K.errors.firstname})})})]}),(0,h.jsxs)("div",{className:"col-lg-6 fv-row",children:[(0,h.jsx)("input",(0,l.Z)({type:"text",className:"form-control form-control-lg form-control-solid",placeholder:"Last name"},K.getFieldProps("lastname"))),K.touched.lastname&&K.errors.lastname&&(0,h.jsx)("div",{className:"fv-plugins-message-container",children:(0,h.jsx)("div",{className:"fv-help-block",children:(0,h.jsx)(h.Fragment,{children:K.errors.lastname})})})]})]})})]}),(0,h.jsxs)("div",{className:"row mb-6",children:[(0,h.jsx)("label",{className:"col-lg-4 col-form-label fw-bold fs-6",children:(0,h.jsx)("span",{className:"required",children:"Mobile Number"})}),(0,h.jsxs)("div",{className:"col-lg-8 fv-row",children:[(0,h.jsx)("input",(0,l.Z)((0,l.Z)({type:"text",className:"form-control form-control-lg form-control-solid",placeholder:"Mobile number"},K.getFieldProps("mobileNumber")),{},{onChange:function(e){return function(e,s){if("Company"==s){var a=Q(e.target.value);D(a)}else{var r=Q(e.target.value);O(r)}}(e,"Mobile")}})),K.touched.mobileNumber&&K.errors.mobileNumber&&(0,h.jsx)("div",{className:"fv-plugins-message-container",children:(0,h.jsx)("div",{className:"fv-help-block",children:(0,h.jsx)(h.Fragment,{children:K.errors.mobileNumber})})})]})]})]}),(0,h.jsx)("div",{className:"card-footer d-flex justify-content-end py-6 px-9",children:(0,h.jsxs)("button",{type:"submit",className:"btn btn-primary",disabled:i,children:[!i&&"Save Changes",i&&(0,h.jsxs)("span",{className:"indicator-progress",style:{display:"block"},children:["Please wait..."," ",(0,h.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]})})]})})]})},x={newEmail:"",confirmPassword:""},p={currentPassword:"",newPassword:"",passwordConfirmation:""},v=c.Ry().shape({newEmail:c.Z_().email("Wrong email format").min(5,"Minimum 5 characters").max(50,"Maximum 50 characters").required("Email is required"),confirmPassword:c.Z_().min(8,"Minimum 8 characters").max(50,"Maximum 50 characters").required("Password is required")}),g=c.Ry().shape({currentPassword:c.Z_().min(8,"Minimum 8 characters").max(50,"Maximum 50 characters").required("Password is required"),newPassword:c.Z_().min(8,"Minimum 8 characters").max(50,"Maximum 50 characters").required("Password is required"),passwordConfirmation:c.Z_().min(8,"Minimum 8 characters").max(50,"Maximum 50 characters").required("Password is required").oneOf([c.iH("newPassword")],"Passwords must match")}),j=function(){var e=(0,r.useState)(x),s=(0,n.Z)(e,2),a=s[0],i=(s[1],(0,r.useState)(p)),c=(0,n.Z)(i,2),f=c[0],b=c[1],j=(0,m.aC)(),w=j.currentUser,N=j.setCurrentUser,y=j.saveAuth,_=j.auth,P=(0,r.useState)(!1),k=(0,n.Z)(P,2),S=k[0],Z=k[1],F=(0,r.useState)(!1),C=(0,n.Z)(F,2),T=C[0],M=C[1],q=(0,r.useState)(!1),A=(0,n.Z)(q,2),E=A[0],U=A[1],I=(0,r.useState)(!0),V=(0,n.Z)(I,2),R=V[0],D=V[1],L=(0,r.useState)(""),W=(0,n.Z)(L,2),H=W[0],O=W[1],Y=(0,r.useState)(""),B=(0,n.Z)(Y,2),X=B[0],z=B[1],G=localStorage.getItem("responsesuccessmsg"),J=localStorage.getItem("responsefailuresmsg"),K=(0,r.useState)(G),Q=(0,n.Z)(K,2),$=Q[0],ee=Q[1],se=(0,r.useState)(J),ae=(0,n.Z)(se,2),re=ae[0],ie=ae[1];""!==H&&setTimeout((function(){U(!1),setTimeout((function(){O("")}),200)}),5e3),""!==X&&setTimeout((function(){U(!1),setTimeout((function(){z("")}),200)}),5e3),G&&setTimeout((function(){localStorage.removeItem("responsesuccessmsg"),D(!1),setTimeout((function(){ee("")}),300)}),5e3),J&&setTimeout((function(){localStorage.removeItem("responsefailuresmsg"),D(!1),setTimeout((function(){ie("")}),300)}),5e3);var le=(0,r.useState)(!1),ne=(0,n.Z)(le,2),te=ne[0],oe=ne[1],ce=(0,d.TA)({initialValues:(0,l.Z)({},a),validationSchema:v,onSubmit:function(e){oe(!0),setTimeout((function(){(0,o.gp)(null===w||void 0===w?void 0:w.id,e.newEmail,e.confirmPassword).then((function(e){e.data.success?(N((function(s){var a=s;a&&(a.accountStatus=e.data.accountStatus,a.email=e.data.email,a.twoFactorAuth=!1);var r=_;return r&&r.user&&(r.user=a),y(r),a})),localStorage.setItem("responsesuccessmsg",e.data.message),window.location.reload()):(U(!0),z(e.data.message),oe(!1))})).catch((function(){U(!0),z("Failed to update email"),oe(!1)}))}),1e3)}}),de=(0,r.useState)(!1),me=(0,n.Z)(de,2),ue=me[0],he=me[1],fe=(0,d.TA)({initialValues:(0,l.Z)({},f),validationSchema:g,onSubmit:function(e){he(!0),setTimeout((function(){(0,o.dC)(null===w||void 0===w?void 0:w.id,e.currentPassword,e.newPassword).then((function(e){e.data.success?(b(p),U(!0),O(e.data.message)):(U(!0),z(e.data.message)),he(!1),M(!1)})).catch((function(e){U(!0),z("Failed to update password"),he(!1),M(!1)}))}),1e3)}});return(0,h.jsxs)("div",{className:"card mb-5 mb-xl-10",children:[(0,h.jsx)("div",{className:"card-header border-0 cursor-pointer",role:"button","data-bs-toggle":"collapse","data-bs-target":"#kt_account_signin_method",children:(0,h.jsx)("div",{className:"card-title m-0",children:(0,h.jsx)("h3",{className:"fw-bolder m-0",children:"Sign-in Method"})})}),""!==H?(0,h.jsx)(u.FP,{message:H,checked:E}):null,""!==X?(0,h.jsx)(u.Nq,{message:X,checked:E}):null,null!==$&&void 0!==$&&""!==$?(0,h.jsx)(u.FP,{message:$,checked:R}):null,null!==re&&void 0!==re&&""!==re?(0,h.jsx)(u.Nq,{message:re,checked:R}):null,(0,h.jsx)("div",{id:"kt_account_signin_method",className:"collapse show",children:(0,h.jsxs)("div",{className:"card-body border-top p-9",children:[(0,h.jsxs)("div",{className:"d-flex flex-wrap align-items-center",children:[(0,h.jsxs)("div",{id:"kt_signin_email",className:" "+(S&&"d-none"),children:[(0,h.jsx)("div",{className:"fs-6 fw-bolder mb-1",children:"Email Address"}),(0,h.jsx)("div",{className:"fw-bold text-gray-600",children:null===w||void 0===w?void 0:w.email})]}),(0,h.jsx)("div",{id:"kt_signin_email_edit",className:"flex-row-fluid "+(!S&&"d-none"),children:(0,h.jsxs)("form",{onSubmit:ce.handleSubmit,id:"kt_signin_change_email",className:"form",noValidate:!0,children:[(0,h.jsxs)("div",{className:"row mb-6",children:[(0,h.jsx)("div",{className:"col-lg-6 mb-4 mb-lg-0",children:(0,h.jsxs)("div",{className:"fv-row mb-0",children:[(0,h.jsx)("label",{htmlFor:"emailaddress",className:"form-label fs-6 fw-bolder mb-3",children:"Enter New Email Address"}),(0,h.jsx)("input",(0,l.Z)({type:"email",className:"form-control form-control-lg form-control-solid",id:"emailaddress",placeholder:"Email Address"},ce.getFieldProps("newEmail"))),ce.touched.newEmail&&ce.errors.newEmail&&(0,h.jsx)("div",{className:"fv-plugins-message-container",children:(0,h.jsx)("div",{className:"fv-help-block",children:ce.errors.newEmail})})]})}),(0,h.jsx)("div",{className:"col-lg-6",children:(0,h.jsxs)("div",{className:"fv-row mb-0",children:[(0,h.jsx)("label",{htmlFor:"confirmemailpassword",className:"form-label fs-6 fw-bolder mb-3",children:"Confirm Password"}),(0,h.jsx)("input",(0,l.Z)({type:"password",className:"form-control form-control-lg form-control-solid",id:"confirmemailpassword"},ce.getFieldProps("confirmPassword"))),ce.touched.confirmPassword&&ce.errors.confirmPassword&&(0,h.jsx)("div",{className:"fv-plugins-message-container",children:(0,h.jsx)("div",{className:"fv-help-block",children:ce.errors.confirmPassword})})]})})]}),(0,h.jsxs)("div",{className:"d-flex",children:[(0,h.jsxs)("button",{id:"kt_signin_submit",type:"submit",className:"btn btn-primary  me-2 px-6",children:[!te&&"Update Email",te&&(0,h.jsxs)("span",{className:"indicator-progress",style:{display:"block"},children:["Please wait..."," ",(0,h.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]}),(0,h.jsx)("button",{id:"kt_signin_cancel",type:"button",onClick:function(){Z(!1)},className:"btn btn-color-gray-400 btn-active-light-primary px-6",children:"Cancel"})]})]})}),(0,h.jsx)("div",{id:"kt_signin_email_button",className:"ms-auto "+(S&&"d-none"),children:(0,h.jsx)("button",{onClick:function(){Z(!0)},className:"btn btn-light btn-active-light-primary",children:"Change Email"})})]}),(0,h.jsx)("div",{className:"separator separator-dashed my-6"}),(0,h.jsxs)("div",{className:"d-flex flex-wrap align-items-center mb-10",children:[(0,h.jsxs)("div",{id:"kt_signin_password",className:" "+(T&&"d-none"),children:[(0,h.jsx)("div",{className:"fs-6 fw-bolder mb-1",children:"Password"}),(0,h.jsx)("div",{className:"fw-bold text-gray-600",children:"************"})]}),(0,h.jsx)("div",{id:"kt_signin_password_edit",className:"flex-row-fluid "+(!T&&"d-none"),children:(0,h.jsxs)("form",{onSubmit:fe.handleSubmit,id:"kt_signin_change_password",className:"form",noValidate:!0,children:[(0,h.jsxs)("div",{className:"row mb-1",children:[(0,h.jsx)("div",{className:"col-lg-4",children:(0,h.jsxs)("div",{className:"fv-row mb-0",children:[(0,h.jsx)("label",{htmlFor:"currentpassword",className:"form-label fs-6 fw-bolder mb-3",children:"Current Password"}),(0,h.jsx)("input",(0,l.Z)({type:"password",className:"form-control form-control-lg form-control-solid ",id:"currentpassword"},fe.getFieldProps("currentPassword"))),fe.touched.currentPassword&&fe.errors.currentPassword&&(0,h.jsx)("div",{className:"fv-plugins-message-container",children:(0,h.jsx)("div",{className:"fv-help-block",children:fe.errors.currentPassword})})]})}),(0,h.jsx)("div",{className:"col-lg-4",children:(0,h.jsxs)("div",{className:"fv-row mb-0",children:[(0,h.jsx)("label",{htmlFor:"newpassword",className:"form-label fs-6 fw-bolder mb-3",children:"New Password"}),(0,h.jsx)("input",(0,l.Z)({type:"password",className:"form-control form-control-lg form-control-solid ",id:"newpassword"},fe.getFieldProps("newPassword"))),fe.touched.newPassword&&fe.errors.newPassword&&(0,h.jsx)("div",{className:"fv-plugins-message-container",children:(0,h.jsx)("div",{className:"fv-help-block",children:fe.errors.newPassword})})]})}),(0,h.jsx)("div",{className:"col-lg-4",children:(0,h.jsxs)("div",{className:"fv-row mb-0",children:[(0,h.jsx)("label",{htmlFor:"confirmpassword",className:"form-label fs-6 fw-bolder mb-3",children:"Confirm New Password"}),(0,h.jsx)("input",(0,l.Z)({type:"password",className:"form-control form-control-lg form-control-solid ",id:"confirmpassword"},fe.getFieldProps("passwordConfirmation"))),fe.touched.passwordConfirmation&&fe.errors.passwordConfirmation&&(0,h.jsx)("div",{className:"fv-plugins-message-container",children:(0,h.jsx)("div",{className:"fv-help-block",children:fe.errors.passwordConfirmation})})]})})]}),(0,h.jsx)("div",{className:"form-text mb-5",children:"Password must be at least 8 character and contain symbols"}),(0,h.jsxs)("div",{className:"d-flex",children:[(0,h.jsxs)("button",{id:"kt_password_submit",type:"submit",className:"btn btn-primary me-2 px-6",children:[!ue&&"Update Password",ue&&(0,h.jsxs)("span",{className:"indicator-progress",style:{display:"block"},children:["Please wait..."," ",(0,h.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]}),(0,h.jsx)("button",{onClick:function(){M(!1)},id:"kt_password_cancel",type:"button",className:"btn btn-color-gray-400 btn-active-light-primary px-6",children:"Cancel"})]})]})}),(0,h.jsx)("div",{id:"kt_signin_password_button",className:"ms-auto "+(T&&"d-none"),children:(0,h.jsx)("button",{onClick:function(){M(!0)},className:"btn btn-light btn-active-light-primary",children:"Reset Password"})})]}),(0,h.jsxs)("div",{className:"notice d-flex bg-light-primary rounded border-primary border border-dashed p-6",children:[(0,h.jsx)(t.D9,{iconName:"shield-tick",className:"fs-2tx text-primary me-4"}),(0,h.jsxs)("div",{className:"d-flex flex-stack flex-grow-1 flex-wrap flex-md-nowrap",children:[(0,h.jsxs)("div",{className:"mb-3 mb-md-0 fw-bold",children:[(0,h.jsx)("h4",{className:"text-gray-800 fw-bolder",children:"Secure Your Account"}),(0,h.jsx)("div",{className:"fs-6 text-gray-600 pe-7",children:"Two-factor authentication adds an extra layer of security to your account. To log in, in addition you'll need to provide a 4 digit code"})]}),(null===w||void 0===w?void 0:w.twoFactorAuth)&&(0,h.jsx)("button",{onClick:function(){(0,o.mf)(null===w||void 0===w?void 0:w.id).then((function(e){e.data.success?(N((function(e){var s=e;s&&(s.twoFactorAuth=!1);var a=_;return a&&a.user&&(a.user=s),y(a),s})),U(!0),O(e.data.message)):(U(!0),z(e.data.message))}))},className:"btn btn-light btn-active-light-primary",children:"Disable"}),!(null!==w&&void 0!==w&&w.twoFactorAuth)&&(0,h.jsx)("button",{className:"btn btn-primary me-2 px-6",onClick:function(){(0,o.HX)(null===w||void 0===w?void 0:w.id).then((function(e){e.data.success?(N((function(e){var s=e;s&&(s.twoFactorAuth=!0);var a=_;return a&&a.user&&(a.user=s),y(a),s})),U(!0),O(e.data.message)):(U(!0),z(e.data.message))}))},disabled:!(null!==w&&void 0!==w&&w.accountStatus),children:"Enable"})]})]})]})})]})};function w(){return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(b,{}),(0,h.jsx)(j,{})]})}var N=function(){return(0,h.jsx)(i.Z5,{children:(0,h.jsxs)(i.AW,{element:(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(i.j3,{})}),children:[(0,h.jsx)(i.AW,{path:"profile",element:(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(w,{})})}),(0,h.jsx)(i.AW,{index:!0,element:(0,h.jsx)(i.Fg,{to:"/user/profile"})})]})})}}}]);
//# sourceMappingURL=226.1d62f86c.chunk.js.map
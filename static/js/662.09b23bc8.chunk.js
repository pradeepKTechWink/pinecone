"use strict";(self.webpackChunkcommunity_ai=self.webpackChunkcommunity_ai||[]).push([[662],{7662:function(e,s,a){a.r(s),a.d(s,{default:function(){return S}});var t=a(885),l=a(2791),r=a(5675),i=a(184),n={1:"Administrator",2:"User",3:"View Only"},c=function(e){var s=(0,l.useState)(!1),a=(0,t.Z)(s,2);a[0],a[1];return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"card mb-5 mb-xl-8",children:(0,i.jsxs)("div",{className:"card-body pt-0 pt-lg-1",children:[(0,i.jsx)("div",{className:"card",children:(0,i.jsx)("div",{className:"card-body d-flex flex-center flex-column pt-12 p-9 px-0",children:(0,i.jsx)("div",{className:"symbol symbol-100px symbol-circle mb-7",children:(0,i.jsx)("img",{src:"".concat("http://34.135.116.158:5050/user-avatars","/").concat(e.userDetail.avatarName),alt:"image"})})})}),(0,i.jsxs)("div",{className:"d-flex flex-stack fs-4 py-3",children:[(0,i.jsxs)("div",{className:"fw-bolder",children:["Details",(0,i.jsx)("span",{className:"ms-2 rotate-180",children:(0,i.jsx)("span",{className:"svg-icon svg-icon-3",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",children:(0,i.jsxs)("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:[(0,i.jsx)("polygon",{points:"0 0 24 0 24 24 0 24"}),(0,i.jsx)("path",{d:"M6.70710678,15.7071068 C6.31658249,16.0976311 5.68341751,16.0976311 5.29289322,15.7071068 C4.90236893,15.3165825 4.90236893,14.6834175 5.29289322,14.2928932 L11.2928932,8.29289322 C11.6714722,7.91431428 12.2810586,7.90106866 12.6757246,8.26284586 L18.6757246,13.7628459 C19.0828436,14.1360383 19.1103465,14.7686056 18.7371541,15.1757246 C18.3639617,15.5828436 17.7313944,15.6103465 17.3242754,15.2371541 L12.0300757,10.3841378 L6.70710678,15.7071068 Z",fill:"#000000",fillRule:"nonzero",transform:"translate(12.000003, 11.999999) rotate(-180.000000) translate(-12.000003, -11.999999)"})]})})})})]}),(0,i.jsx)("span",{children:(0,i.jsx)("div",{className:"btn btn-sm btn-light-primary",onClick:function(){return e.setShowUserUpdateDialog(!0)},children:"Edit"})})]}),(0,i.jsx)("div",{className:"separator"}),(0,i.jsxs)("div",{id:"kt_user_view_details",className:"show",children:[(0,i.jsxs)("div",{className:"pb-5 fs-6",children:[(0,i.jsx)("div",{className:"fw-bolder mt-5",children:"First Name"}),(0,i.jsx)("div",{className:"text-gray-600",children:(0,i.jsx)("span",{className:"text-gray-600",children:e.userDetail.firstname})})]}),(0,i.jsxs)("div",{className:"pb-5 fs-6",children:[(0,i.jsx)("div",{className:"fw-bolder mt-5",children:"Last Name"}),(0,i.jsx)("div",{className:"text-gray-600",children:(0,i.jsx)("span",{className:"text-gray-600",children:e.userDetail.lastname})})]}),(0,i.jsxs)("div",{className:"pb-5 fs-6",children:[(0,i.jsx)("div",{className:"fw-bolder mt-5",children:"Email"}),(0,i.jsx)("div",{className:"text-gray-600",children:(0,i.jsxs)("span",{className:"text-gray-600",children:[e.userDetail.email,e.userDetail.accountStatus&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("span",{"data-bs-toggle":"tooltip",title:"Verified",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"mb-1 ms-2 bi bi-check-circle-fill text-success",viewBox:"0 0 16 16",children:(0,i.jsx)("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"})})})}),!e.userDetail.accountStatus&&(0,i.jsx)("span",{"data-bs-toggle":"tooltip",title:"Not Verified",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"mb-1 ms-2 bi bi-x-circle-fill text-danger",viewBox:"0 0 16 16",children:(0,i.jsx)("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"})})})]})})]}),(0,i.jsxs)("div",{className:"pb-5 fs-6",children:[(0,i.jsx)("div",{className:"fw-bolder mt-5",children:"Mobile Number"}),(0,i.jsx)("div",{className:"text-gray-600",children:(0,i.jsx)("span",{className:"text-gray-600",children:e.userDetail.mobileNumber})})]}),(0,i.jsxs)("div",{className:"pb-5 fs-6",children:[(0,i.jsx)("div",{className:"fw-bolder mt-5",children:"User Role"}),(0,i.jsx)("div",{className:"text-gray-600",children:(0,i.jsx)("span",{className:"text-gray-600",children:n[e.userDetail.role.toString()]})})]}),(0,i.jsxs)("div",{className:"pb-5 fs-6",children:[(0,i.jsx)("div",{className:"fw-bolder mt-5",children:"Account Deletion Status"}),(0,i.jsxs)("div",{className:"text-gray-600",children:[e.userDetail.accountBlocked&&(0,i.jsx)("div",{className:"btn btn-sm btn-light-primary",onClick:function(){return e.openDialogForUserDeletion("undelete-user-".concat(e.userID))},children:"Unmark Deletion"}),!e.userDetail.accountBlocked&&(0,i.jsx)("div",{className:"btn btn-sm btn-light-danger",onClick:function(){return e.openDialogForUserDeletion("delete-user-".concat(e.userID))},children:"Mark for Deletion"})]})]})]})]})})})},o=function(e){return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"card pt-4 mb-6 mb-xl-9",children:[(0,i.jsx)("div",{className:"card-header border-0",children:(0,i.jsx)("div",{className:"card-title",children:(0,i.jsx)("h2",{children:"Update Password"})})}),(0,i.jsx)("div",{className:"card-body pt-0 pb-5",children:(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsx)("table",{className:"table align-middle table-row-dashed gy-5",id:"kt_table_users_login_session",children:(0,i.jsx)("tbody",{className:"fs-6 fw-bold text-gray-600",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"ps-3",children:"Password"}),(0,i.jsx)("td",{children:"******"}),(0,i.jsx)("td",{className:"text-end pe-3",children:(0,i.jsx)("button",{type:"button",className:"btn btn-icon btn-active-light-primary w-30px h-30px ms-auto",onClick:function(){return e.setShowPasswordUpdateDialog(!0)},children:(0,i.jsx)("span",{className:"svg-icon svg-icon-3",children:(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,i.jsx)("rect",{opacity:"0.25",x:"3",y:"21",width:"18",height:"2",rx:"1",fill:"#191213"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.08576 11.5L3.58579 12C3.21071 12.375 3 12.8838 3 13.4142V17C3 18.1045 3.89543 19 5 19H8.58579C9.11622 19 9.62493 18.7893 10 18.4142L10.5 17.9142L4.08576 11.5Z",fill:"#121319"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.5 10.0858L11.5858 4L18 10.4142L11.9142 16.5L5.5 10.0858Z",fill:"#121319"}),(0,i.jsx)("path",{opacity:"0.25",fillRule:"evenodd",clipRule:"evenodd",d:"M18.1214 1.70705C16.9498 0.535476 15.0503 0.535476 13.8787 1.70705L13 2.58576L19.4142 8.99997L20.2929 8.12126C21.4645 6.94969 21.4645 5.0502 20.2929 3.87862L18.1214 1.70705Z",fill:"#191213"})]})})})})]})})})})})]})})},d=a(1413),m=a(6871),u=a(4889),h=a(9157),x=a(2116),p=a(2270),f=a(4153),b=a(1795),g=a(7665),j=f.Ry().shape({firstname:f.Z_().required("First Name is required"),lastname:f.Z_().required("Last Name is required"),email:f.Z_().email("Wrong email format").min(3,"Minimum 3 symbols").max(50,"Maximum 50 symbols").required("Email is required"),mobileNumber:f.Z_().min(14,"Minimum 10 numbers").max(14,"Maximum 10 numbers").required("Mobile number is required")}),v=function(e){(0,m.s0)();var s=(0,g.aC)().currentUser,a=(0,l.useState)(null===s||void 0===s?void 0:s.companyId),n=(0,t.Z)(a,1)[0],c=(0,l.useState)(!1),o=(0,t.Z)(c,2),f=o[0],v=o[1],N=(0,l.useState)(""),w=(0,t.Z)(N,2),y=w[0],k=w[1],D=(0,l.useState)(""),C=(0,t.Z)(D,2),S=C[0],U=C[1],F=(0,l.useState)(""),_=(0,t.Z)(F,2),M=_[0],Z=_[1],P=(0,l.useState)(null===s||void 0===s?void 0:s.phoneNumber),R=(0,t.Z)(P,2),L=(R[0],R[1]),T=(0,b.TA)({initialValues:{firstname:"",lastname:"",email:"",mobileNumber:""},validationSchema:j,onSubmit:function(s){v(!0),setTimeout((function(){var a=new FormData;a.append("userId",e.userID),a.append("companyId",n?n.toString():""),a.append("firstname",s.firstname),a.append("lastname",s.lastname),a.append("email",s.email),a.append("mobileNumber",s.mobileNumber),a.append("role",S),a.append("image",y),(0,r.l4)(a).then((function(s){s.data.success?(e.setUserDetail((function(e){var a=e;return a.firstname=s.data.userData.firstname,a.lastname=s.data.userData.lastname,a.email=s.data.userData.email,a.mobileNumber=s.data.userData.mobileNumber,a.avatarName=s.data.userData.avatarName,a.role=s.data.userData.role,a})),e.setSuccessResMessage(s.data.message),e.setChecked(!0),v(!1)):(e.setChecked(!0),e.setFailureResMessage(s.data.message),v(!1))})).then((function(){e.setShowUserUpdateDialog(!1)})).catch((function(s){console.log(s),e.setChecked(!0),e.setFailureResMessage("Failed to update user, try again later"),e.setShowUserUpdateDialog(!1),v(!1)}))}),1e3)}});(0,l.useEffect)((function(){T.setFieldValue("mobileNumber",M)}),[M]);var I=function(e){if(!e)return e;var s=e.replace(/[^\d]/g,""),a=s.length;return a<4?s:a<7?"(".concat(s.slice(0,3),") ").concat(s.slice(3)):"(".concat(s.slice(0,3),") ").concat(s.slice(3,6),"-").concat(s.slice(6,10))};return(0,l.useEffect)((function(){e.userDetail&&(T.setFieldValue("firstname",e.userDetail.firstname),T.setFieldValue("lastname",e.userDetail.lastname),T.setFieldValue("email",e.userDetail.email),T.setFieldValue("mobileNumber",e.userDetail.mobileNumber),U(e.userDetail.role))}),[e.userDetail]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(u.Z,{open:e.showUserUpdateDialog,onClose:function(){return e.setShowUserUpdateDialog(!1)},"aria-labelledby":"form-dialog-title",children:[(0,i.jsx)(x.Z,{className:"px-5 text-center fw-bolder text-muted",id:"form-dialog-title",children:(0,i.jsxs)("div",{className:"modal-header",id:"kt_modal_update_user_header",children:[(0,i.jsx)("h2",{className:"fw-bolder",children:"Update User"}),(0,i.jsx)("div",{className:"btn btn-icon btn-sm btn-active-icon-primary",onClick:function(){return e.setShowUserUpdateDialog(!1)},children:(0,i.jsx)("span",{className:"svg-icon svg-icon-1",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",children:(0,i.jsxs)("g",{transform:"translate(12.000000, 12.000000) rotate(-45.000000) translate(-12.000000, -12.000000) translate(4.000000, 4.000000)",fill:"#000000",children:[(0,i.jsx)("rect",{fill:"#000000",x:"0",y:"7",width:"16",height:"2",rx:"1"}),(0,i.jsx)("rect",{fill:"#000000",opacity:"0.5",transform:"translate(8.000000, 8.000000) rotate(-270.000000) translate(-8.000000, -8.000000)",x:"0",y:"7",width:"16",height:"2",rx:"1"})]})})})})]})}),(0,i.jsx)(h.Z,{children:(0,i.jsxs)("form",{style:{width:"380px"},className:"form",onSubmit:T.handleSubmit,id:"kt_modal_update_user_form",children:[(0,i.jsx)("div",{className:"modal-body px-5",children:(0,i.jsx)("div",{className:"d-flex flex-column scroll-y me-n7 pe-7",id:"kt_modal_update_user_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_update_user_header","data-kt-scroll-wrappers":"#kt_modal_update_user_scroll","data-kt-scroll-offset":"300px",children:(0,i.jsxs)("div",{id:"kt_modal_update_user_user_info",className:"show",children:[(0,i.jsxs)("div",{className:"mb-7",children:[(0,i.jsxs)("label",{className:"fs-6 fw-bold mb-2 me-5",children:[(0,i.jsx)("span",{children:"Update Avatar"}),(0,i.jsx)("i",{className:"fas fa-exclamation-circle ms-1 fs-7","data-bs-toggle":"tooltip",title:"Allowed file types: png, jpg, jpeg."})]}),(0,i.jsx)("div",{className:"mt-5",children:(0,i.jsxs)("div",{className:"image-input image-input-outline","data-kt-image-input":"true",style:{backgroundImage:"url(".concat((0,p.BY)("/media/avatars/blank.png"),")"),marginLeft:"5px"},children:[(0,i.jsx)("div",{className:"image-input-wrapper w-125px h-125px",style:{backgroundImage:"url(".concat(""===y?"".concat("http://34.135.116.158:5050/user-avatars","/").concat(e.userDetail.avatarName):URL.createObjectURL(y),")")}}),(0,i.jsxs)("label",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"change","data-bs-toggle":"tooltip",title:"Change avatar",children:[(0,i.jsx)("i",{className:"bi bi-pencil-fill fs-7"}),(0,i.jsx)("input",{onChange:function(e){return function(e){k(e.target.files[0])}(e)},type:"file",name:"avatar",accept:".png, .jpg, .jpeg"}),(0,i.jsx)("input",{type:"hidden",name:"avatar_remove"})]}),(0,i.jsx)("span",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"cancel","data-bs-toggle":"tooltip",title:"Cancel avatar",children:(0,i.jsx)("i",{className:"bi bi-x fs-2"})}),(0,i.jsx)("span",{className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow","data-kt-image-input-action":"remove","data-bs-toggle":"tooltip",title:"Remove avatar",children:(0,i.jsx)("i",{className:"bi bi-x fs-2"})})]})})]}),(0,i.jsxs)("div",{className:"fv-row mb-7",children:[(0,i.jsx)("label",{className:"required fs-6 fw-bold mb-2",children:"First Name"}),(0,i.jsx)("input",(0,d.Z)({type:"text",className:"form-control form-control-solid",placeholder:"First Name"},T.getFieldProps("firstname"))),T.touched.firstname&&T.errors.firstname&&(0,i.jsx)("div",{className:"fv-plugins-message-container",children:(0,i.jsx)("div",{className:"fv-help-block",children:T.errors.firstname})})]}),(0,i.jsxs)("div",{className:"fv-row mb-7",children:[(0,i.jsx)("label",{className:"required fs-6 fw-bold mb-2",children:"Last Name"}),(0,i.jsx)("input",(0,d.Z)({type:"text",className:"form-control form-control-solid",placeholder:"Last Name"},T.getFieldProps("lastname"))),T.touched.lastname&&T.errors.lastname&&(0,i.jsx)("div",{className:"fv-plugins-message-container",children:(0,i.jsx)("div",{className:"fv-help-block",children:T.errors.lastname})})]}),(0,i.jsxs)("div",{className:"fv-row mb-7",children:[(0,i.jsx)("label",{className:"required fs-6 fw-bold mb-2",children:"Mobile Number"}),(0,i.jsx)("input",(0,d.Z)((0,d.Z)({type:"text",className:"form-control form-control-solid",placeholder:"Mobile Number"},T.getFieldProps("mobileNumber")),{},{onChange:function(e){return function(e,s){if("Company"==s){var a=I(e.target.value);L(a)}else{var t=I(e.target.value);Z(t)}}(e,"Mobile")}})),T.touched.mobileNumber&&T.errors.mobileNumber&&(0,i.jsx)("div",{className:"fv-plugins-message-container",children:(0,i.jsx)("div",{className:"fv-help-block",children:T.errors.mobileNumber})})]}),(0,i.jsxs)("div",{className:"fv-row mb-7",children:[(0,i.jsxs)("label",{className:"required fs-6 fw-bold mb-2",children:[(0,i.jsx)("span",{children:"Email"}),(0,i.jsx)("i",{className:"fas fa-exclamation-circle ms-1 fs-7","data-bs-toggle":"tooltip",title:"Email address must be active"})]}),(0,i.jsx)("input",(0,d.Z)({type:"email",className:"form-control form-control-solid",placeholder:"Email"},T.getFieldProps("email"))),T.touched.email&&T.errors.email&&(0,i.jsx)("div",{className:"fv-plugins-message-container",children:(0,i.jsx)("div",{className:"fv-help-block",children:T.errors.email})})]}),(0,i.jsxs)("div",{className:"fv-row mb-8",children:[(0,i.jsx)("label",{className:"form-label fw-bold text-dark fs-6",children:"User Role"}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{className:"d-flex align-items-center justify-content-between mb-6 cursor-pointer",children:[(0,i.jsx)("span",{className:"d-flex align-items-center me-2",children:(0,i.jsx)("span",{className:"d-flex flex-column",children:(0,i.jsx)("span",{className:"fw-bold text-muted fs-6",children:"Administrator"})})}),(0,i.jsx)("span",{className:"form-check form-check-custom form-check-solid",children:(0,i.jsx)("input",{className:"form-check-input",type:"radio",name:"orgType",value:"Administrator",checked:"1"==S,onChange:function(){return U("1")}})})]}),(0,i.jsxs)("label",{className:"d-flex align-items-center justify-content-between mb-6 cursor-pointer",children:[(0,i.jsx)("span",{className:"d-flex align-items-center me-2",children:(0,i.jsx)("span",{className:"d-flex flex-column",children:(0,i.jsx)("span",{className:"fw-bold text-muted fs-6",children:"User"})})}),(0,i.jsx)("span",{className:"form-check form-check-custom form-check-solid",children:(0,i.jsx)("input",{className:"form-check-input",type:"radio",name:"orgType",value:"User",checked:"2"==S,onChange:function(){return U("2")}})})]}),(0,i.jsxs)("label",{className:"d-flex align-items-center justify-content-between mb-6 cursor-pointer",children:[(0,i.jsx)("span",{className:"d-flex align-items-center me-2",children:(0,i.jsx)("span",{className:"d-flex flex-column",children:(0,i.jsx)("span",{className:"fw-bold text-muted fs-6",children:"View Only"})})}),(0,i.jsx)("span",{className:"form-check form-check-custom form-check-solid",children:(0,i.jsx)("input",{className:"form-check-input",type:"radio",name:"orgType",value:"View Only",checked:"3"==S,onChange:function(){return U("3")}})})]})]})]})]})})}),(0,i.jsxs)("div",{className:"modal-footer flex-center",children:[(0,i.jsx)("button",{type:"reset",className:"btn btn-light me-3",onClick:function(){return e.setShowUserUpdateDialog(!1)},children:"Discard"}),(0,i.jsxs)("button",{type:"submit",className:"btn btn-primary",children:[(0,i.jsx)("span",{className:"indicator-label",children:"Submit"}),f&&(0,i.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]})]})})]})})},N=function(e){var s=(0,l.useState)(!1),a=(0,t.Z)(s,2),n=(a[0],a[1]);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"card pt-4 pb-6 mb-xl-9",children:[(0,i.jsx)("div",{className:"card-header border-0",children:(0,i.jsx)("div",{className:"card-title",children:(0,i.jsx)("h2",{children:"Two Factor Authentication"})})}),(0,i.jsx)("div",{className:"card-body pt-0 pb-5",children:(0,i.jsxs)("div",{className:"notice d-flex bg-light-primary rounded border-primary border border-dashed p-6",children:[(0,i.jsx)(p.D9,{iconName:"shield-tick",className:"fs-2tx text-primary me-4"}),(0,i.jsxs)("div",{className:"d-flex flex-stack flex-grow-1 flex-wrap flex-md-nowrap",children:[(0,i.jsxs)("div",{className:"mb-3 mb-md-0 fw-bold",children:[(0,i.jsx)("h4",{className:"text-gray-800 fw-bolder",children:"Secure User Account"}),(0,i.jsx)("div",{className:"fs-6 text-gray-600 pe-7",children:"Two-factor authentication adds an extra layer of security to the user accounts. To log in, in addition, the user needs to provide a 4 digit code"})]}),e.userDetail.twoFactorAuth&&(0,i.jsx)("button",{className:"btn btn-secondary me-2 px-6",onClick:function(){(0,r.Ic)(e.userID).then((function(s){s.data.success?(e.setUserDetail((function(e){var s=e;return s.twoFactorAuth=!1,s})),e.setSuccessResMessage(s.data.message),e.setChecked(!0),n(!1)):(e.setFailureResMessage(s.data.message),e.setChecked(!0),n(!1))})).catch((function(s){console.log(s),e.setFailureResMessage("Failed to disable 2FA due to internal error"),e.setChecked(!0),n(!1)}))},children:"Disable"}),!e.userDetail.twoFactorAuth&&(0,i.jsx)("button",{className:"btn btn-primary me-2 px-6",onClick:function(){(0,r.UK)(e.userID).then((function(s){s.data.success?(e.setUserDetail((function(e){var s=e;return s.twoFactorAuth=!0,s})),e.setSuccessResMessage(s.data.message),e.setChecked(!0),n(!1)):(e.setFailureResMessage(s.data.message),e.setChecked(!0),n(!1))})).catch((function(s){console.log(s),e.setFailureResMessage("Failed to enable 2FA due to internal error"),e.setChecked(!0),n(!1)}))},children:"Enable"})]})]})})]})})},w=f.Ry().shape({newPassword:f.Z_().min(8,"Minimum 8 characters").max(50,"Maximum 50 characters").required("Password is required"),changepassword:f.Z_().min(8,"Minimum 8 characters").max(50,"Maximum 50 characters").required("Password confirmation is required").oneOf([f.iH("newPassword")],"Password and Confirm Password didn't match")}),y={newPassword:"",changepassword:""},k=function(e){(0,m.s0)();var s=(0,l.useState)(!1),a=(0,t.Z)(s,2),n=a[0],c=a[1],o=(0,b.TA)({initialValues:y,validationSchema:w,onSubmit:function(s){c(!0),setTimeout((function(){(0,r.qL)(e.userID,s.newPassword).then((function(s){s.data.success?(e.setSuccessResMessage(s.data.message),e.setChecked(!0),c(!1)):(e.setChecked(!0),e.setFailureResMessage(s.data.message),c(!1))})).then((function(){e.setShowPasswordUpdateDialog(!1)})).catch((function(s){e.setChecked(!0),e.setFailureResMessage("Failed to update user, try again later"),e.setShowPasswordUpdateDialog(!1),c(!1)}))}),1e3)}});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(u.Z,{open:e.showPasswordUpdateDialog,onClose:function(){return e.setShowPasswordUpdateDialog(!1)},"aria-labelledby":"form-dialog-title",children:[(0,i.jsx)(x.Z,{className:"px-5 text-center fw-bolder text-muted",id:"form-dialog-title",children:(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsx)("h2",{className:"fw-bolder",children:"Update Password"}),(0,i.jsx)("div",{className:"btn btn-icon btn-sm btn-active-icon-primary",onClick:function(){return e.setShowPasswordUpdateDialog(!1)},children:(0,i.jsx)("span",{className:"svg-icon svg-icon-1",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",children:(0,i.jsxs)("g",{transform:"translate(12.000000, 12.000000) rotate(-45.000000) translate(-12.000000, -12.000000) translate(4.000000, 4.000000)",fill:"#000000",children:[(0,i.jsx)("rect",{fill:"#000000",x:"0",y:"7",width:"16",height:"2",rx:"1"}),(0,i.jsx)("rect",{fill:"#000000",opacity:"0.5",transform:"translate(8.000000, 8.000000) rotate(-270.000000) translate(-8.000000, -8.000000)",x:"0",y:"7",width:"16",height:"2",rx:"1"})]})})})})]})}),(0,i.jsx)(h.Z,{children:(0,i.jsxs)("form",{id:"kt_modal_update_password_form",className:"form",onSubmit:o.handleSubmit,children:[(0,i.jsxs)("div",{className:"mb-10 fv-row","data-kt-password-meter":"true",children:[(0,i.jsxs)("div",{className:"mb-1",children:[(0,i.jsx)("label",{className:"required form-label fw-bold fs-6 mb-2",children:"New Password"}),(0,i.jsxs)("div",{className:"position-relative mb-3",children:[(0,i.jsx)("input",(0,d.Z)({className:"form-control form-control-lg form-control-solid",type:"password",placeholder:"New Password",autoComplete:"off"},o.getFieldProps("newPassword"))),o.touched.newPassword&&o.errors.newPassword&&(0,i.jsx)("div",{className:"fv-plugins-message-container",children:(0,i.jsx)("div",{className:"fv-help-block text-danger",children:o.errors.newPassword})})]})]}),(0,i.jsx)("div",{className:"text-muted",children:"Use 8 or more characters with a mix of letters, numbers & symbols."})]}),(0,i.jsxs)("div",{className:"fv-row mb-10",children:[(0,i.jsx)("label",{className:"required form-label fw-bold fs-6 mb-2",children:"Confirm Password"}),(0,i.jsx)("input",(0,d.Z)({className:"form-control form-control-lg form-control-solid",type:"password",placeholder:"Confirm Password",autoComplete:"off"},o.getFieldProps("changepassword"))),o.touched.changepassword&&o.errors.changepassword&&(0,i.jsx)("div",{className:"fv-plugins-message-container",children:(0,i.jsx)("div",{className:"fv-help-block text-danger",children:o.errors.changepassword})})]}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("button",{type:"reset",className:"btn btn-light me-3",onClick:function(){return e.setShowPasswordUpdateDialog(!1)},children:"Discard"}),(0,i.jsxs)("button",{type:"submit",className:"btn btn-primary",children:[(0,i.jsx)("span",{className:"indicator-label",children:"Submit"}),n&&(0,i.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]})]})})]})})},D=a(1640),C=a(4059),S=function(e){var s=(0,m.TH)().state,a=(0,l.useState)(!1),n=(0,t.Z)(a,2),d=n[0],u=n[1],h=(0,l.useState)(!0),x=(0,t.Z)(h,2),p=x[0],f=x[1],b=(0,l.useState)(!1),j=(0,t.Z)(b,2),w=j[0],y=j[1],S=(0,l.useState)(null),U=(0,t.Z)(S,2),F=U[0],_=U[1],M=(0,l.useState)(!1),Z=(0,t.Z)(M,2),P=Z[0],R=Z[1],L=(0,l.useState)(!1),T=(0,t.Z)(L,2),I=T[0],q=T[1],A=localStorage.getItem("resSuccess"),B=(0,l.useState)(A),E=(0,t.Z)(B,2),V=E[0],z=E[1],O=localStorage.getItem("resFailure"),H=(0,l.useState)(O),X=(0,t.Z)(H,2),W=X[0],K=X[1],Y=(0,l.useState)(""),G=(0,t.Z)(Y,2),J=G[0],Q=G[1],$=(0,l.useState)(""),ee=(0,t.Z)($,2),se=ee[0],ae=ee[1],te=(0,l.useState)(!0),le=(0,t.Z)(te,2),re=le[0],ie=(le[1],(0,g.aC)().auth),ne=(0,m.s0)();(0,l.useEffect)((function(){var e;1!=(null===ie||void 0===ie||null===(e=ie.user)||void 0===e?void 0:e.role)&&ne("/error/404")}),[]),null!==V&&void 0!==V&&setTimeout((function(){u(!1),localStorage.removeItem("resSuccess"),setTimeout((function(){z(null)}),300)}),5e3),null!==W&&void 0!==W&&setTimeout((function(){u(!1),localStorage.removeItem("resFailure"),setTimeout((function(){K(null)}),300)}),5e3),J&&setTimeout((function(){u(!1),setTimeout((function(){Q("")}),200)}),5e3),se&&setTimeout((function(){u(!1),setTimeout((function(){ae("")}),200)}),5e3);var ce=function(e){document.getElementById(e).style.display="none"};(0,l.useEffect)((function(){(0,r.TB)(s).then((function(e){_(e.data.userData),f(!1)})).catch((function(e){console.log(e)}))}),[]);return(0,i.jsxs)(i.Fragment,{children:[void 0!==J&&null!==J&&""!==J?(0,i.jsx)(C.FP,{message:J,checked:d}):null,void 0!==se&&null!==se&&""!==se?(0,i.jsx)(C.Nq,{message:se,checked:d}):null,null!==V&&void 0!==V&&""!==V?(0,i.jsx)(C.FP,{message:V,checked:re}):null,null!==W&&void 0!==W&&""!==W?(0,i.jsx)(C.Nq,{message:W,checked:re}):null,!p&&(0,i.jsx)("div",{className:"post d-flex flex-column-fluid",id:"kt_post",children:(0,i.jsxs)("div",{id:"kt_content_container",className:"container",children:[(0,i.jsxs)("div",{className:"d-flex flex-column flex-xl-row",children:[(0,i.jsx)("div",{className:"flex-column flex-lg-row-auto w-100 w-xl-400px mb-10",children:(0,i.jsx)(c,{userID:s,showUserUpdateDialog:P,setShowUserUpdateDialog:R,userDetail:F,setUserDetail:_,setSuccessResMessage:Q,setFailureResMessage:ae,setChecked:u,openDialogForUserDeletion:function(e){document.getElementById(e).style.display="block"}})}),(0,i.jsx)("div",{className:"flex-lg-row-fluid ms-lg-15",children:(0,i.jsx)("div",{className:"tab-content",id:"myTabContent",children:(0,i.jsxs)("div",{className:"tab-pane show active",id:"kt_user_view_overview_security",role:"tabpanel",children:[(0,i.jsx)(o,{showPasswordUpdateDialog:I,setShowPasswordUpdateDialog:q}),(0,i.jsx)(N,{userID:s,userDetail:F,setUserDetail:_,setSuccessResMessage:Q,setFailureResMessage:ae,setChecked:u})]})})}),(0,i.jsxs)("div",{id:"delete-user-".concat(s),style:{display:"none"},className:"modal",children:[(0,i.jsx)("span",{onClick:function(){return ce("delete-user-".concat(s))},className:"close",title:"Close Modal",children:"\xd7"}),(0,i.jsx)("form",{className:"modal-content bg-white",children:(0,i.jsxs)("div",{className:"px-7 py-7",children:[(0,i.jsx)("h3",{children:"Mark account for deletion"}),(0,i.jsx)("p",{className:"font-size-15",children:"Are you sure that you want to mark this account for deletion?"}),(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsx)("button",{onClick:function(){return ce("delete-user-".concat(s))},type:"button",className:"btn btn-primary",children:"Cancel"}),(0,i.jsxs)("button",{onClick:function(){return y(!0),void(0,r.bT)(s).then((function(e){e.data.success?(_((function(e){var s=e;return s.accountBlocked=!0,s})),Q(e.data.message),u(!0),y(!1)):(ae(e.data.message),u(!0),y(!1))})).then((function(){ce("delete-user-".concat(s)),window.scrollTo(0,0)})).catch((function(e){ae("Failed to blacklist user account due to internal error"),u(!0),y(!1),ce("delete-user-".concat(s)),window.scrollTo(0,0)}))},type:"button",className:"btn btn-danger ms-3",children:["Delete",w&&(0,i.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]})]})})]}),(0,i.jsxs)("div",{id:"undelete-user-".concat(s),style:{display:"none"},className:"modal",children:[(0,i.jsx)("span",{onClick:function(){return ce("undelete-user-".concat(s))},className:"close",title:"Close Modal",children:"\xd7"}),(0,i.jsx)("form",{className:"modal-content bg-white",children:(0,i.jsxs)("div",{className:"px-7 py-7",children:[(0,i.jsx)("h3",{children:"Unmark account from deletion"}),(0,i.jsx)("p",{className:"font-size-15",children:"Are you sure that you want to unmark this account from deletion?"}),(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsx)("button",{onClick:function(){return ce("undelete-user-".concat(s))},type:"button",className:"btn btn-secondary",children:"Cancel"}),(0,i.jsxs)("button",{onClick:function(){return y(!0),void(0,r.Ss)(s).then((function(e){e.data.success?(_((function(e){var s=e;return s.accountBlocked=!1,s})),Q(e.data.message),u(!0),y(!1)):(ae(e.data.message),u(!0),y(!1))})).then((function(){ce("undelete-user-".concat(s)),window.scrollTo(0,0)})).catch((function(e){ae("Failed to whitelist user account due to internal error"),u(!0),y(!1),ce("undelete-user-".concat(s)),window.scrollTo(0,0)}))},type:"button",className:"btn btn-primary ms-3",children:["Unmark",w&&(0,i.jsx)("span",{className:"spinner-border spinner-border-sm align-middle ms-2"})]})]})]})})]})]}),(0,i.jsx)(v,{userID:s,showUserUpdateDialog:P,setShowUserUpdateDialog:R,userDetail:F,setUserDetail:_,setSuccessResMessage:Q,setFailureResMessage:ae,setChecked:u}),(0,i.jsx)(k,{userID:s,showPasswordUpdateDialog:I,setShowPasswordUpdateDialog:q,setSuccessResMessage:Q,setFailureResMessage:ae,setChecked:u})]})}),p&&(0,i.jsx)("div",{className:"d-flex w-100 h-100",children:(0,i.jsx)("div",{className:"my-auto mx-auto",children:(0,i.jsxs)("div",{className:"d-flex flex-column justify-content-center",children:[(0,i.jsx)("span",{className:"text-primary fs-3",children:"Loading"})," ",(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"ms-4",children:(0,i.jsx)(D.Z,{})})]})})})]})}}}]);
//# sourceMappingURL=662.09b23bc8.chunk.js.map